<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>GadgetZon</title>
     <link rel="shortcut icon" href="\images\online-shopping.png">
    <link rel="stylesheet" href="/stylesheets/user/shop-page.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.0.2/css/boxicons.min.css">
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
</head>
<body>
  <nav  class="navbar navbar-expand-md   navbar-dark bg-dark main-menu sticky-top" style=" box-shadow:none;;
  width: 100%; z-index:100;">
  <div class="container">
    <a class="navbar-brand" href="/">
      <h4 class="font-weight-bold"><h3>Gadget<font color="#FFD523">Zon</font></h3></h4>
    </a>

    <ul class="navbar-nav ml-auto d-block d-md-none">
      <li class="nav-item">
        <a style="color: white;" class="btn btn-link" href="/cart"><i style="font-size: 30px;" class="bx bxs-cart icon-single" ></i><span id="count"   class="badge badge-warning">{{count}}</span></a>
      <a style="color: white;" class="btn btn-link" href="/wishlist"><i class="bi bi-bag-heart-fill"></i></a>
    </li>
    </ul>

    <div class="collapse navbar-collapse">
      <form class="form-inline my-2 my-lg-0 mx-auto" action="/search-product" role="search" >
        <input class="form searchsize" name="productname" type="search" placeholder="  Search for products..." aria-label="Search" >
        <button style="background-color: #F26522;" class="btn my-2 my-sm-0" type="submit"><i class="bx bx-search"></i></button>
      </form>

      <ul class="navbar-nav">
        <li class="nav-item">
          <a style="color: white;" class="btn btn-link" href="/cart"><i style="font-size: 30px;" class="bx bxs-cart icon-single" ></i><span id="count"   class="badge badge-warning">{{count}}</span></a>
        </li>

        <li class="nav-item">
          <a style="color: white;" class="btn btn-link" href="/wishlist"><i  style="font-size: 20px;" class="bi bi-bag-heart-fill"></i></a>
        </li>
      
      </ul>
    </div>

  </div>
</nav>

<div style="position: fixed; width: 100%; z-index: 50;" class="search-bar d-block d-md-none bg-dark">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <form class="form-inline mb-3 mx-auto" action="/search-product" role="search">
          <input class="form-control" name="productname" type="search" placeholder="Search for products..." aria-label="Search"  style="width: 288px;">
          <button  style="background-color: #F26522;" class="btn " type="submit"><i class="bx bx-search"></i></button>
        </form>
      </div>
    </div>
  </div>
</div>


<section  class="section1  ">
<div class="catg-div">
<div style="width: auto; float: left; margin-top: 5px;     margin-left: 40px;"  class="dropdown show">
  <a class=" drop-size btn border border-dark dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
   Category
  </a>

  <div class="dropdown-menu" aria-labelledby="dropdownMenuLink" style="background-color: rgba(225, 227, 226, 0.9);">
      <a class="dropdown-item" href="/categoryList/all"> All</a>
    {{#each catg }}
    <a class="dropdown-item" href="/categoryList/{{this.categoryname}}"> {{this.categoryname}}</a>
    {{/each}}
  </div>
</div>


<div style="width: auto; float: left; margin-top: 5px;"  class="dropdown show" >
  <a   class=" drop-size  btn border border-dark dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
   sort
  </a>

  <div class="dropdown-menu" aria-labelledby="dropdownMenuLink" style="background-color: rgba(225, 227, 226, 0.9);">
    <a class="dropdown-item" href="/sortProduct/high">price high to low</a>
    <a class="dropdown-item" href="/sortProduct/low">price low to high</a>
  </div>
</div>


</div>



 </section>

 {{#if session}}   
 <div  class=" row row-cols-1 row-cols-md-4 row-cols-lg-4 g-4 mt-5" style=" width: 100%; margin-left: 5px;">
  {{#each result}}
  <div  class="col mb-4" >
    <a style="text-decoration: none; color: black;" href="/productDetails/{{this._id}}"> 
    <div style="    border-radius: 11px; border-color: rgb(12, 12, 14);"  class="card h-100">
      <div style="display: flex;justify-content: center;">
       <img  src="{{this.main_image.[0].url}}" class="card-img1 " alt="Hollywood Sign on The Hill" />
      </div></a>
      <div class="card-body">
        <h5 style=" text-align: center;  height: 30px;" class="card-title">{{this.productname}}</h5>
        <h4 style=" height: 30px; text-align: center;" class="card-title">Rs.{{this.price}}</h4>
       
      <div style="display: flex;justify-content: center;">
        {{!-- <a href="/addToCart/{{this._id}}"><input align="center" type="submit" class=" btn btn-warning" value="Add to cart"></a> --}}
        <button class=" btn btn-warning" onclick="addToCart('{{this._id}}')"  >Add to cart</button>

        <!-- Modal -->
<div   class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div style="background-color: #d8ccc6; height: 150px;" class="modal-content">
     
      <div class="modal-body">
        <div>    <h5 style="text-align: center; font-weight: bold; font-family: cursive;" class="modal-title" id="exampleModalLongTitle">Product Added to cart successfully</h5>
       </div>
       <div style="height: 18px;"></div>
       <div style="display: flex; justify-content: center;">
        <button type="button" class="btn btn-dark" data-dismiss="modal">Close</button>&emsp;
         
        <a href="/cart" type="button" class="btn btn-warning">Go to cart</a>
       </div>
      </div>
       
    </div>
  </div>
</div>
 <!-- Modal End -->

       {{#if this.wishlist}}
        <a href="/deleteWishlist/{{this._id}}"><i style="font-size: 25px; margin-top: -10px; color: red;" class="bi bi-heart-fill btn pl-3" ></i>
       {{else}}
        <a href="/addToWishlist/{{this._id}}"><i style="font-size: 25px; margin-top: -10px;" class="bi bi-heart btn pl-3" ></i>
        {{/if}}
      </div>
      </div>
    </div>
    </a>
  </div>
  
  {{/each}} 
</div>
 
{{else}}
<div  class=" row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4 mt-5" style=" width: 100%; margin-left: 5px;">
  {{#each result}}
  <div  class="col mb-4" >
    <a style="text-decoration: none; color: black;" href="/productDetails/{{this._id}}"> 
    <div style="    border-radius: 11px; border-color: rgb(12, 12, 14);"  class="card h-100">
      <div style="display: flex;justify-content: center;">
       <img  src="{{this.main_image.[0].url}}" class="card-img1 " alt="Hollywood Sign on The Hill" />
      </div></a>
      <div class="card-body">
        <h5 style=" text-align: center;  height: 30px;" class="card-title">{{this.productname}}</h5>
        <h4 style=" height: 30px; text-align: center;" class="card-title">Rs.{{this.price}}</h4>
       
      <div style="display: flex;justify-content: center;">
        {{!-- <a href="/addToCart/{{this._id}}"><input align="center" type="submit" class=" btn btn-warning" value="Add to cart"></a> --}}
        <button class=" btn btn-warning" onclick="addToCart('{{this._id}}')">Add to cart</button>
        <a href="/addToWishlist/{{this._id}}"><i style="font-size: 25px; margin-top: -10px;" class="bi bi-heart btn pl-3" ></i>
     
      </div>
      </div>
    </div>
    </a>
  </div>
  {{/each}} 
  
</div>
{{/if}}
<nav aria-label="Page navigation example">
  <ul class="pagination" style="justify-content: center;">
    <li class="page-item">
      <a class="page-link" href="#" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    {{#each pagination}}
    <li class="page-item"><a class="page-link" href="/shop-page/?page={{inc @index}}">{{inc @index}}</a></li>
    {{/each}}
    <li class="page-item">
      <a class="page-link" href="#" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>
</nav>

{{!-- 
<script src="https://code.jquery.com/jquery-3.1.1.min.js"> 
 </script> --}}

{{!-- <script src="/javascripts/addToCart.js"></script> --}}
    
 {{!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> --}}
 {{!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css"></script> --}}
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
 <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
 
<script>function addToCart(proId){
  
     axios.get('/addToCart/'+proId).then((response)=>{
      console.log(response)
      if(response?.data?.count){
        
         document.getElementById('count').innerText=response.data.count
         $("#exampleModalCenter").modal();
      }else{
        window.location.href='/login'
       
      }
     
      
    }).catch(err=>{
      console.log(err)
    })
}
function addToWish(proID){
  axios.get('addToWishlist/'+proID).then((resp)=>{
    console.log(resp)
  }).catch(err=>{
    console.log(err)
  })
}
function deleteWl(proID){
  axios.get('deleteWishlist/'+proID).then((resp)=>{
    console.log(resp)
  }).catch(err=>{
    console.log(err)
  })
}
</script>
</body>
</html>